import React, { useState } from 'react'
import axios from 'axios'
import {
  CButton,
  CCard,
  CCardBody,
  CCardFooter,
  CCardHeader,
  CCol,
  CForm,
  CFormGroup,
  CFormText,
  CTextarea,
  CInput,
  CInputFile,
  CInputCheckbox,
  CInputRadio,
  CLabel,
  CSelect,
  CRow,
  CSwitch
} from '@coreui/react'
import CIcon from '@coreui/icons-react'

const Upload = () => {

  const [docfile, setDocFile] = React.useState();
  const [remarque, setRemarque] = React.useState();

  // const config = {
  //   headers: {
  //     'Authorization': `Bearer ${localStorage.getItem('token')}`,
  //     'Content-Type': 'multipart/form-data'
  //   }
  // };

  const submitForm = (event) => {
    event.preventDefault();

    const dataArray = new FormData();
    dataArray.append("remarque", remarque);
    dataArray.append("docfile", docfile[0]);
    console.log(docfile[0])

    axios
      .post("http://localhost:8000/api/files_upload/upload/", dataArray, {
        headers: {
          'Authorization': `Bearer ${localStorage.getItem('token')}`,
          // 'Content-Type': 'multipart/form-data'
        }
      })
      .then((response) => {
        console.log(response)
      })
      .catch((error) => {
        console.log(error)
      });
  };

  const [collapsed, setCollapsed] = React.useState(true)
  const [showElements, setShowElements] = React.useState(true)

  return (
    <>
    <CRow>
    <CCol xs="12">
        <CCard>
        <CCardHeader>
            File Upload
            {/* <small> Elements</small> */}
        </CCardHeader>
        <CCardBody>
            <CForm onSubmit={submitForm} className="form-horizontal">
              <CFormGroup row>
                  <CLabel col md={3}>Veuillez ins√©rer votre fichier</CLabel>
                  <CCol xs="12" md="9">
                  <CInputFile custom id="custom-file-input" onChange={(e) => setDocFile(e.target.files)}/>
                  <CLabel htmlFor="custom-file-input" variant="custom-file">
                      Choose file...
                  </CLabel>
                  </CCol>
                  <CInput 
                      type="text" 
                      name="remarque"
                      placeholder="Remarque" 
                      onChange={(e) => setRemarque(e.target.value)}
                    />
              </CFormGroup>
              <CCardFooter>
                <CButton type="submit" size="sm" color="primary"><CIcon name="cil-scrubber" /> Submit</CButton>
                <CButton type="reset" size="sm" color="danger"><CIcon name="cil-ban" /> Reset</CButton>
            </CCardFooter>
            </CForm>
        </CCardBody>
        </CCard>
    </CCol>
    </CRow>
    </>
  )
}

export default Upload
